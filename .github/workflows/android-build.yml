- name: Download Android command-line tools (mirror)
  shell: bash
  run: |
    set -euo pipefail
    cd "$ANDROID_HOME/cmdline-tools"

    # Mirror URL (always works on GitHub runners)
    URL="https://dl-ssl.google.com/android/repository/commandlinetools-linux-9123335_latest.zip"
    OUT=cmdline-tools.zip

    echo "Downloading Android command-line tools from mirror..."
    curl -L -o "$OUT" "$URL"
    echo "Testing ZIP..."
    unzip -tq "$OUT"

    echo "Unzipping..."
    unzip -q "$OUT"

    if [ -d "cmdline-tools" ]; then
      mv cmdline-tools latest
    fi

    rm "$OUT"
